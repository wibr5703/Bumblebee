---
title: "Lab5_Bumblebee"
author: "William Brickowski, Rachael Robinson, Manasi Raol, Brady Kiesling"
date: "2/14/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Lab 5

## Goals:

### Identify overall trends in the milk production dataset

### Hypothesize possible explanations for these trends and identify additional data sources that cound be helpful

## Team Section:

### Yearly time series for the milk production (in millions of pounds) by selected States
```{r}

```

### The year when the most milk was produced in the United States
```{r}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

m_year=milk %>% group_by(year) %>% summarize(Production=sum(milk_million)) %>% arrange(desc(Production))
m_year[1,]
```
In 2017, 215466 million pounds were produced.

### The year when the least milk was produced in the United States
```{r}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

l_year=milk %>% group_by(year) %>% summarize(Production=sum(milk_million)) %>% arrange(Production)
l_year[1,]
```
In 1975, 115398 pounds were produced.

### In 2017, report the 5 states that produced the most milk
```{r}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

m_states=milk %>% filter(year==2017) %>% arrange(desc(milk_million))
m_states[1:5,c(2,3,5)]
```
In 2017, California produced 39,798 million pounds, Wisconsin produced 30,320 million pounds, New York produced 14,912 million pounds, Idaho produced 14,627 million pounds, and Texas produced 12,054 million pounds.

### In 2017, report the 5 states that produced the least milk
```{r}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

l_states=milk %>% filter(year==2017) %>% arrange(milk_million)
l_states[1:5,c(2,3,5)]
```
In 2017, Alaska produced 3 million pounds, Rhode Island produced 13 million pounds, Hawaii produced 39 million pounds, Arkansas produced 79 million pounds, and Alabama produced 89 million pounds.

## What we found to be the most helpful in learning about this data:

### William
What I found most usefull in learning about the State Milk Production data set was the ability to use dplyr functions in conjunction with the pipe in order to gain understanding of a subset of the data with a particular function applied to it. For example, in my computation of the 5 states that produced the most amount of milk in 2017, I filtered the year to be 2017 and then used the arrange function in the descending order to determine a list of the 5 states. The summarize function was also essential when trying to determine the year when the most milk was produced in the United States. First, I grouped by year and then summmarized based on the sum of milk_million attribute of our data table. I also found the geom_density() function to be really helpful when looking at the distribution of milk production within a particular year. It paints a better picture than a histogram because the histogram is sensative to the bin size.

### Rachael

### Brady

What I found the most helpful in this activity was really leaning how to use the dplyr funtions in order to format data more effectivly in order to analyze the data more thoroughly. For my section, I created a new data set: milk1999 which only contained the data from that year. I make a simple density chart, graphing the disibuion of how much milk each state produced in a year. Using the milk1999 data set, i could use the mean and median fuctions to find the mean and median. In order to find the min and max, I created new variables with the data in 1999 in both ascending and descending order by milk production. I then only listed the first entry in the data set to get both the min and the max production value.

### Manasi

## Individual Section:

### William
```{r}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

#Display the distribution of the yearly milk production (in millions of pounds) for 1997
milk1997 <- milk %>%
  filter(year == 1997)

ggplot(data = milk1997, aes(x = milk_million)) +
  geom_density() + 
  ggtitle('Distribution estimate of milk produced in 1997')

#Report the average milk produced by each state
milk1997 %>%
summarize(Average = mean(milk_million))

#Report the median milk produced be each state
milk1997 %>%
summarize(Median = median(milk_million))

#Report the state that produced the most milk
most = milk1997 %>% arrange(desc(milk_million))
most[1,]

#Report the state that produced the least amount of milk
least = milk1997 %>% arrange(milk_million)
least[1,]
```
Above is a density plot of the distribution of milk produced in 1997. The average milk produced this year was 3,121.82 million pounds. The mediam milk produced this year was 1,436 million pounds. The state that produced the most milk this year was California, and they produced 27,582 million pounds. The state that produced the least amount of milk this year was Alaska, and they produced 15 million pounds.

### Rachael

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::kable
# Load tidyverse
library(tidyverse)
library(tidyverse)
library(knitr)
# Load and view the data
milk <- read.csv('state_milk_production.csv')


milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)

milk1998 <- milk %>%
  filter(year == 1998)


```

```{r, echo = FALSE, warning = FALSE}
ggplot(data = milk1998, mapping = aes(x=milk_million)) +
  geom_density(bins=11, size = 1.5, color = "blue") +
  ggtitle("Distribution of US milk production in 1970") +
  theme_minimal() +
  xlab("Milk in millions of pounds")
```

```{r, include = FALSE}
  meanmilk <- mean(milk1998$milk_million)
  medmilk <- median(milk1998$milk_million)
  meanmilk
  medmilk
```

The plot shows the distribution of milk production in the US for the year 1998. From the plot, it's clear that the density is higher in the lower milk productions, from 0 to 4,000 million pounds. However, it appears there are a few states acting as outliers in the higher milk productions.

When evaluating the data for 1998, I have calcuated the average milk produced across all states to be 3145.22 millions of pounds.

The median was calculated to be 1411.5 millions of pounds.

The large discrepency between the median and the mean, along with the outliers observed, indicates that the mean is skewed upward.

The following is a table representing the top 5 states for milk production in the year 1998:

```{r, results = 'asis', echo = FALSE}

mostmilk <- milk1998 %>%
  select(state, milk_million) %>%
  arrange(desc(milk_million))

kable(mostmilk[1:5,])
```

This indicates that the highest producing state in 1998 was California with 27620 million pounds of milk.

This table shows the 5 states with the lowest milk production in the year 1998:

```{r, results = 'asis', echo = FALSE}

mostmilk <- milk1998 %>%
  select(state, milk_million) %>%
  arrange(desc(milk_million))

kable(mostmilk[45:50,])

```

This indicates that the lowest producing state in 1998 was Alaska with 14 million pounds of milk.


### Brady

```{r echo = TRUE, message = F, warning = F}
milk <- read.csv('state_milk_production.csv')
head(milk)

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000) 

milk1999 <- milk %>%
  filter(year==1999)
milk1999

milkdata<-milk1999$milk_million

ggplot(data=milk1999)+
  geom_density(aes(x=milk_million))



mean(milkdata)
median(milkdata)

most<-milk1999%>%
  arrange(desc(milk_million))
most[1,]

least<-milk1999%>%
  arrange(milk_million)
least[1,]
```
Above I have summarized the data about milk production in the year 1999, the density plot shows that the milk production had a big right skew, meaning a lot of the milk was produced in a few states. This is backed up by the mean value being much higher than the median value. Not suprizingly, alaska produced the least milk, because the climate does not favor dairy production, and California had the most milk production, probably due to the big population and the hospitable climate.

### Manasi


