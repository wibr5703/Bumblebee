---
title: "Lab4_Bumblebee"
author: "Rachael Robinson, William Brickowski, Manasi Raol, Brady Kiesling"
date: "2/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Lab 4

## Team Questions:
  * Does smoking lead to babies born prematurely?
  * Does smoking lead to low birth weight? 

## Why are these questions important?
Reason: These questions are important because health behaviors during pregnancy are often a topic of interest. Determining what behaviors are more or less likely to result in healthy babies is important because it can inform women and families to improve health outcomes. Smoking in particular is an important question of interest due to the number of smokers during the 1960s, in which this data was collected.
  * This reason is important because it has wide-reaching impacts on generational health. Widespread habits can result in health affects on entire populations of babies, which could lead to consequences as this population of babies grows into adulthood. Trends in low birth weights or premature births could eventually impact the quality of life, labor, and health of larger populations.

## Team Plots:


### Question 1
```{r}
ggplot(data=babies)+
  geom_boxplot(aes(y=gestation, x=as.factor(smoke)),outlier.shape = NA)+
  geom_hline(yintercept=270)+
  ylim(250,320)+
  labs(x="Non-smoking vs smoking", y="days of gestation", title="Distibution of gestation days")
```  
The boxplot represents days of gestation, and the line across represents 270 days. Babies born under that line are considered premature. Even though the median birth day for smokers is slightly lower, the lengh of the line under the 270 mark is roughly the same for both smoking mothers and non-smoking mothers. This means that there is no significant difference in the proportion of smoking and non-smoking mothers giving birth prematurely. This plot seems to refute the 1989 claim that mothers smoking causes premature births.
  

### Question 2

## Conclusions:
  * Answer to first question
  * Answer to second question
  
## Recommendations:

### Recommendation for Q1

### Recommendation for Q2

## Preliminary Team Questions:
  * Which variables are similar between smokers and nonsmokers? Which are different?

## Team Plots for Prelimary Questions:
```{r}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`) 
babies = na.omit(babies)
babies$smoke <- as.factor(babies$smoke)

ggplot(data=babies,aes(x=smoke,y=gestation,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Length of gestation by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=bwtoz,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Birth weight of baby by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=parity,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Total number of previous pregnancies by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=mage,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Mother age by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=med,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Mother educaiton by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=mht,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Mother height by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=mpregwt,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Mother weight by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=dage,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Father age by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=ded,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Father education by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=dht,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Father height by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=dwt,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Father weight by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=marital,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Marital status of mother by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=inc,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Family yearly income by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=time,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Time since quiting by smokers and non-smokers')

ggplot(data=babies,aes(x=smoke,y=Premature,fill=smoke)) +
  geom_bar(aes(y=..count../sum(..count..),fill=smoke),position="dodge")+
  xlab('Smoke: 0 "never" and 1"smokes now"')+
  ylab('Normalized Count')+
  ggtitle('Percent of premature child birth by smokers and non-smokers')
```

## Conclusions for Prelimary Questions:
Based on these prelimnary graphs which exam the difference among the majority of the variables in the dataframe between smokers and none smokers, there have been several differences identified. For mothers who do not smoke, their length of gestation is longer. The birth weight of babies born to a mother who does not smoke is larger than for babies born to a mother who does. Mothers who do not smoke tend to be younger and more education, the same goes for the father. Additionally, for both mothers and fathers, on average, those who do not smoke are taller and heavier.


## Individual Plots

### William
```{r}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`) 
babies = na.omit(babies)
babies$smoke <- as.factor(babies$smoke)
  
  ggplot(data = babies, aes(x = mpregwt, y = gestation, color = smoke)) +  
  geom_point() +                                                     
  ggtitle('Length of gestation in days verses the pre-pregnancy weight of the mother') +                         
  xlab('Pre-pregnancy weight') +                                              
  ylab('Gestation') +                                              
  scale_color_discrete(name = 'Smoke:',                              
                       labels = c('Never Smokes', 'Smokes Now')) +
  geom_smooth()
```
This is a scatter plot whose x variable is the gestation period in days and whose y value is the pre-pregnancy weight of the  mother. The graph shows data for mothers who have never smoked and those who smoke. For both smokers and non-smokers, their is a quite clear linear trend in which mothers with a larger pre-preganancy weight have a longer gestation period. This is true up until a certain weight, and at this point the trend becomes the opposite. This could describe the part of the sample that is overweight and unhealthy. The distinction between smokers and non-smokers is that the line of best fit for smokers appears to be the same from non-smokers, however, it is shifted down slightly. This means that for the same pre-pregnancy weight, non-smokers have longer gestation periods. Additionally, based on the preliminary graphs which show that mothers who smoke tend to weigh less, this could explain why smokers in general have shorter gestation periods. Again, due to the presence of confounding variables, correlation cannot be confused with causation and further testing would be required to generate a more definite conclusion.

### Brady

### Manasi

### Rachael


## Individual contribution and non-defaults for plot generation

### William
Within this lab, I generated the preliminary graphs as well as wrote the conclusion that corresponds to them. We say several interesting relationships between whether the mother smokes with respect to other variables. The one that sparked my individual exploration was that mothers with a smaller pre-pregnancy weight tended to be smokers and mothers who did not smoke weighed more. Another graph that further led to my individual research was one that showed that smokers had shorted gestation periods and non-smokers had longer ones. From these two graphs, I was interest in perhaps determining if weight was a confounding variable. For this reason, I graphed a scatter plot relating pre-pregnancy weight and gestation period for both smokers and non-smokers. The results confirmed my intuition, mothers who weighed more, up until a certain point, had longer gestation periods. With regards to the non-defaults for plot generation, on the plots that I generated within the preliminary section, I normlaized the data through a parameter within the geom_bar function. This had to be done because there were not an equal number of mothers who smoked and who did not smoke. I also added x labels and y labels to these preliminary plots as well as a title. Furthermore, I used the position parameter with the geom_bar function to dodge the bar charts so that smokers and non-smokers could be compared side by side. With respect to my individual plot titled "Length of gestation in days verses the pre-pregnancy weight of the mother", I added the color parameter to the ggplot function so that I could get a scatter plot seperated by color based on smokers and non-smokers. I then added a title and x/y labels. I added a scale title and changed the label names. Additionally, I made use of the geom_smooth function so that lines up best fit could easily be compared to make conclusion upon the data.

### Brady

### Manasi

### Rachael
